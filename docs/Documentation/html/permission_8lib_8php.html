<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<title>Pragyan CMS: cms/permission.lib.php File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="doxygen.css" rel="stylesheet" type="text/css"/>
</head>
<body>
<!-- Generated by Doxygen 1.7.1 -->
<div class="navigation" id="top">
  <div class="tabs">
    <ul class="tablist">
      <li><a href="main.html"><span>Main&nbsp;Page</span></a></li>
      <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
      <li><a href="namespaces.html"><span>Namespaces</span></a></li>
      <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
  <div class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&nbsp;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div>
<div class="header">
  <div class="summary">
<a href="#namespaces">Namespaces</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<h1>cms/permission.lib.php File Reference</h1>  </div>
</div>
<div class="contents">

<p><a href="permission_8lib_8php_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr><td colspan="2"><h2><a name="namespaces"></a>
Namespaces</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">namespace &nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="namespacepragyan.html">pragyan</a></td></tr>

<p><tr><td class="mdescLeft">&nbsp;</td><td class="mdescRight"><p>Widget Framework for Pragyan CMS  (c) 2010 Pragyan Team  <a href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a> GNU Public License For more details, see README  Add support for File Upload/Download via the widget's configurations  Reload Widgets ,Get Widget Instances. see bottom. </p>
<br/></td></tr>
</p>
<tr><td colspan="2"><h2><a name="func-members"></a>
Functions</h2></td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#aaafedab4208c1d50294e76527849a5d0">renderArray</a> ($array)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#af14b3b0b8976c34f0a102d0f2c0cc941">inner</a> ($smallobj)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#a609ddef8893e3f08d3739e5888e10884">customjson</a> ($objDesc)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#a5e84c3a4e413a84ccf9a7b7a266336a4">getAllPermissionsOnPage</a> ($pagepath, $modifiableGroups, $grantableActions)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#af5005eca1bc2b127df5adb7e50d08024">getPermissionId</a> ($<a class="el" href="interfacemodule.html">module</a>, $action)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#a3550018b46336678dd99531d64871183">getPagePermission</a> (array $pagePath, $usergroupid, $action, $<a class="el" href="interfacemodule.html">module</a>, $permtype= 'group')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#a295ec8be7e8cbc39ff46957274ffbb02">getPermissions</a> ($userid, $pageid, $action, $<a class="el" href="interfacemodule.html">module</a>=&quot;&quot;)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#a080aa817715d2604bac8f6b4c776abda">determineGrantTargetId</a> (&amp;$targettype)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#a65c515e949846055f84c223cdb7b21c3">grantPermissions</a> ($userid, $pageid)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#a005dafc189cb27ff69ad017960ef2cfa">getPerms</a> ($pageId, $groupuser, $yesno)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#a7f10fa4068c9a090a4a95e13b7ae35e4">customGetAllUsers</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#a5a6a43e7e31b6d5d6bea2604c371b881">customGetGroups</a> ($priority)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#a6bcadef8c7da37eb84ae95bb9b07e069">getAllPermissions</a> ()</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#a8002ed86c26089c9a8f328694d3c07ac">unsetPagePermission</a> ($usergroupid, $pageid, $action, $<a class="el" href="interfacemodule.html">module</a>, $permtype= 'group')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#a4e8d0d3163ccf917bcb5f1845f30b461">setPagePermission</a> ($usergroupid, $pageid, $action, $<a class="el" href="interfacemodule.html">module</a>, $permission, $permtype= 'group')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#a52da6a95c3faac536fb2182551bf8ba6">getMaxPriorityGroup</a> (&amp;$pagepath, $userid, &amp;$groupids, &amp;$virtue)</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#a099fdc856a4ec9b9c42c1f89b9723fa5">getModifiableGroups</a> ($userId, $maxPriorityGroup, $ordering= 'asc')</td></tr>
<tr><td class="memItemLeft" align="right" valign="top">&nbsp;</td><td class="memItemRight" valign="bottom"><a class="el" href="permission_8lib_8php.html#a58026f593767679afe4a7767c178ae33">getGroupPermissions</a> ($groupids, $pagepath, $userid=-1)</td></tr>
</table>
<hr/><h2>Function Documentation</h2>
<a class="anchor" id="a7f10fa4068c9a090a4a95e13b7ae35e4"></a><!-- doxytag: member="permission.lib.php::customGetAllUsers" ref="a7f10fa4068c9a090a4a95e13b7ae35e4" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">customGetAllUsers </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00681">681</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
<a class="anchor" id="a5a6a43e7e31b6d5d6bea2604c371b881"></a><!-- doxytag: member="permission.lib.php::customGetGroups" ref="a5a6a43e7e31b6d5d6bea2604c371b881" args="($priority)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">customGetGroups </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>priority</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00690">690</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
<a class="anchor" id="a609ddef8893e3f08d3739e5888e10884"></a><!-- doxytag: member="permission.lib.php::customjson" ref="a609ddef8893e3f08d3739e5888e10884" args="($objDesc)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">customjson </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>objDesc</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00048">48</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
<a class="anchor" id="a080aa817715d2604bac8f6b4c776abda"></a><!-- doxytag: member="permission.lib.php::determineGrantTargetId" ref="a080aa817715d2604bac8f6b4c776abda" args="(&amp;$targettype)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">determineGrantTargetId </td>
          <td>(</td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>targettype</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Determines the id of the user or group for which permissions are being set from a form generated by getGrantForm() </p>
<dl class="return"><dt><b>Returns:</b></dt><dd>Integer, containing the id of the user or group, a value less than 0 indicating failure </dd></dl>

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00401">401</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
<a class="anchor" id="a6bcadef8c7da37eb84ae95bb9b07e069"></a><!-- doxytag: member="permission.lib.php::getAllPermissions" ref="a6bcadef8c7da37eb84ae95bb9b07e069" args="()" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getAllPermissions </td>
          <td>(</td>
          <td class="paramname"></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00699">699</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
<a class="anchor" id="a5e84c3a4e413a84ccf9a7b7a266336a4"></a><!-- doxytag: member="permission.lib.php::getAllPermissionsOnPage" ref="a5e84c3a4e413a84ccf9a7b7a266336a4" args="($pagepath, $modifiableGroups, $grantableActions)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getAllPermissionsOnPage </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>pagepath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>modifiableGroups</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>grantableActions</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Generates a table showing the permissions of all users and visible groups on a particular page </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$pagepath</em>&nbsp;</td><td>Array containing the path to the current page </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$modifiableGroups</em>&nbsp;</td><td>Array containing the groups for which permissions are to be viewed </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$grantableActions</em>&nbsp;</td><td>Array containing the module =&gt; actions for which permissions must be shown </td></tr>
  </table>
  </dd>
</dl>

<p><p>$grantableActions is of the form: $grantableActions['moduleName_i'] = array( array1(permid, actionname, actiondescription), array2(permid, actionname, actiondescription) )</p>
<p>Retrieve Ids and Names of all groups</p>
<p>&lt; Associative array relative group ids to group names</p>
<p>Retrieve Ids and Names of all users</p>
<p>$permList: Array of the form $permList[$permId] = array($moduleName, $actionName, $actionDescription)</p>
<p>Retrieve all the permissions set on the page path $groupSetPermissions and $userSetPermissions are arrays of the form $&lt;user/group&gt;SetPermissions[pageid][&lt;user/group&gt;id][permid] = true / false / unset This array will be used later to compute $groupEffectivePermissions and $userEffectivePermission</p>
<p>Now, compute effective permissions for all groups. Computing for groups first will make things easier for users (yeah, right!)</p>
<p>Loop 1 counts down through page numbers. Loop 2 takes each group Loop 3 takes each permission Inside loop three, if the groupSetPermissions for pageid, groupid, permid is set, check if groupEffectivePermissions has been set for that groupid and permid Yes: If groupEffectivePermissions is false, leave it as such. Otherwise, copy setPerm No: copySetPermissions</p>
<p>$pSP stands for SetPermissions for that particular pageId and $gSP stands for SetPermissions for that particular groupId on that pageId. $pSP is a 2D array, and $gSP is a 1D array, respectively (see their initializations) $gEP stands for Effective Permissions for a group on the current page as calculated so far pSP, gSP and gEP are aimed at reducing the number of times the 3D array needs to be indexed and at making the code a little easier to read</p>
<p>Now to compute the effective permissions for the users</p>
<p>Get all the groups each user belongs to</p>
<p>Calculate permissions as far as groups are concerned. </p>
</p>

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00058">58</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
<a class="anchor" id="a58026f593767679afe4a7767c178ae33"></a><!-- doxytag: member="permission.lib.php::getGroupPermissions" ref="a58026f593767679afe4a7767c178ae33" args="($groupids, $pagepath, $userid=&#45;1)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getGroupPermissions </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>groupids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>pagepath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>userid</em> = <code>-1</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Retrieves a list of actions a user has on a given page </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>groupids</em>&nbsp;</td><td>The groups to which the person belongs </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>pagepath</em>&nbsp;</td><td>Array containing page ids representing the nodes on the path to the page </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Array containing the modules, pointing to list of actions the user can perform on that module </dd></dl>

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00859">859</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
<a class="anchor" id="a52da6a95c3faac536fb2182551bf8ba6"></a><!-- doxytag: member="permission.lib.php::getMaxPriorityGroup" ref="a52da6a95c3faac536fb2182551bf8ba6" args="(&amp;$pagepath, $userid, &amp;$groupids, &amp;$virtue)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getMaxPriorityGroup </td>
          <td>(</td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>pagepath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>userid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>groupids</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">&amp;$&nbsp;</td>
          <td class="paramname"> <em>virtue</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Retrieves the group of maximum priority that gives the concerned user the grant permission at a given page </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$pagepath</em>&nbsp;</td><td>An array containing the page ids of the nodes leading to the current page </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$userid</em>&nbsp;</td><td>User id of the current user </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$groupids</em>&nbsp;</td><td>The list of ids of the groups to which the user belongs, ordered by priority </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$virtue</em>&nbsp;</td><td>String indicating whether the user obtained grant individually or through a group </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Integer representing the id of the group with the maxmimum priority, -1 in case no such group was found </dd></dl>

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00801">801</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
<a class="anchor" id="a099fdc856a4ec9b9c42c1f89b9723fa5"></a><!-- doxytag: member="permission.lib.php::getModifiableGroups" ref="a099fdc856a4ec9b9c42c1f89b9723fa5" args="($userId, $maxPriorityGroup, $ordering= 'asc')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getModifiableGroups </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>userId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>maxPriorityGroup</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>ordering</em> = <code>'asc'</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p><p>"SELECT `$groupsTable`.`group_id`, `$groupsTable`.`group_name`, `$groupsTable`.`group_description`, `$groupsTable`.`group_priority` " . "FROM `$groupsTable` WHERE `group_priority &lt;= (SELECT `group_priority` FROM `$groupsTable` WHERE `group_id` = $maxPriorityGroup)</p>
<p>OLD QUERY: *** "SELECT `$groupsTable`.`group_id`, `$groupsTable`.`group_name`, `$groupsTable`.`group_description`, `$groupsTable`.`group_priority` " . "FROM `$groupsTable`, `$usergroupTable` " . "WHERE `$usergroupTable`.`user_id` = $userId AND `$usergroupTable`.`group_id` = `$groupsTable`.`group_id` " . "AND `$groupsTable`.`group_priority` &lt;= " . "(SELECT `group_priority` FROM `$groupsTable` WHERE `group_id` = $maxPriorityGroup) " . "ORDER BY `$groupsTable`.`group_priority` $ordering";</p>
</p>

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00819">819</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
<a class="anchor" id="a3550018b46336678dd99531d64871183"></a><!-- doxytag: member="permission.lib.php::getPagePermission" ref="a3550018b46336678dd99531d64871183" args="(array $pagePath, $usergroupid, $action, $module, $permtype= 'group')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getPagePermission </td>
          <td>(</td>
          <td class="paramtype">array $&nbsp;</td>
          <td class="paramname"> <em>pagePath</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>usergroupid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>permtype</em> = <code>'group'</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Checks whether a given group has a given permission over a given page </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$pagePath</em>&nbsp;</td><td>Array of integers, containing the pageids of each node in the path to the current page </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$usergroupid</em>&nbsp;</td><td>Id of the group or user </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$action</em>&nbsp;</td><td>String containing the name of the action requested </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$module</em>&nbsp;</td><td>Name of the module </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$permtype</em>&nbsp;</td><td>String indicating whether $usergroupid contains a group id or a user id </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Boolean indicating whether the user or group has the requested permission </dd></dl>

<p><p>For the group under consideration, find permission for the page: From leaf node upto root, return false on finding first 'no' If permission is unset even after going till the root, return false</p>
<p>&lt; -1 for unset </p>
</p>

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00319">319</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
<a class="anchor" id="af5005eca1bc2b127df5adb7e50d08024"></a><!-- doxytag: member="permission.lib.php::getPermissionId" ref="af5005eca1bc2b127df5adb7e50d08024" args="($module, $action)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getPermissionId </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>action</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00295">295</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
<a class="anchor" id="a295ec8be7e8cbc39ff46957274ffbb02"></a><!-- doxytag: member="permission.lib.php::getPermissions" ref="a295ec8be7e8cbc39ff46957274ffbb02" args="($userid, $pageid, $action, $module=&quot;&quot;)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getPermissions </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>userid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>pageid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>module</em> = <code>&quot;&quot;</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Finds out if a given user has the permission to perform a given action on a given page </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$userid</em>&nbsp;</td><td>User Id of the user </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$pagePath</em>&nbsp;</td><td>Array of integers, containing the pageids of each node in the path to the current page </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$action</em>&nbsp;</td><td>String representing the requested action </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$module</em>&nbsp;</td><td>String containing the name of the requested module </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Boolean indicating whether the user has the requested permission or not </dd></dl>

<p><p>Find all groups the user belongs to, ordered by priority For each group, starting with lowest priority, get permission for the page </p>
</p>

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00366">366</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
<a class="anchor" id="a005dafc189cb27ff69ad017960ef2cfa"></a><!-- doxytag: member="permission.lib.php::getPerms" ref="a005dafc189cb27ff69ad017960ef2cfa" args="($pageId, $groupuser, $yesno)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">getPerms </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>pageId</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>groupuser</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>yesno</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00664">664</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
<a class="anchor" id="a65c515e949846055f84c223cdb7b21c3"></a><!-- doxytag: member="permission.lib.php::grantPermissions" ref="a65c515e949846055f84c223cdb7b21c3" args="($userid, $pageid)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">grantPermissions </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>userid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>pageid</em></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Determines which permissions a user can grant, and to which groups and users on a given page </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$userid</em>&nbsp;</td><td>User id of the user attempting to grant permissions </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$pagepath</em>&nbsp;</td><td>Array containing the page ids of the nodes on the path to the given page </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$modifiableGroups</em>&nbsp;</td><td>Buffer to store the groups the user can grant permissions to </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$grantableActions</em>&nbsp;</td><td>Buffer to store the list of actions the user can grant permissions for </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Boolean, indicating whether the function was successful </dd></dl>

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00457">457</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
<a class="anchor" id="af14b3b0b8976c34f0a102d0f2c0cc941"></a><!-- doxytag: member="permission.lib.php::inner" ref="af14b3b0b8976c34f0a102d0f2c0cc941" args="($smallobj)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">inner </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>smallobj</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00038">38</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
<a class="anchor" id="aaafedab4208c1d50294e76527849a5d0"></a><!-- doxytag: member="permission.lib.php::renderArray" ref="aaafedab4208c1d50294e76527849a5d0" args="($array)" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">renderArray </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>array</em></td>
          <td>&nbsp;)&nbsp;</td>
          <td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p><a class="el" href="permission_8lib_8php.html">permission.lib.php</a>: Everything to do with page and module permissions</p>
<p>TODO: One should also be able to View a resultant "group" permission table. Like we have for users now. Coz one needs to be able to see the resultant permission set for a not logged in user right?. DONE: call getPermissionTable passing a negative userid and as many group ids as you need as the groupids array Generates a list of usernames, and email ids that match a given pattern </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$pattern</em>&nbsp;</td><td>Pattern for which suggestions must be found </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>string A comma separated string ready to be sent back to the client </dd></dl>

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00030">30</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
<a class="anchor" id="a4e8d0d3163ccf917bcb5f1845f30b461"></a><!-- doxytag: member="permission.lib.php::setPagePermission" ref="a4e8d0d3163ccf917bcb5f1845f30b461" args="($usergroupid, $pageid, $action, $module, $permission, $permtype= 'group')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">setPagePermission </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>usergroupid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>pageid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>permission</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>permtype</em> = <code>'group'</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Sets permission for a user or group at a particular level, for a given action and module </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$usergroupid</em>&nbsp;</td><td>Id of the user or group for which the permission is to be set </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$pageid</em>&nbsp;</td><td>Id of the page at which level the permission is to be set </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$action</em>&nbsp;</td><td>Action for which the permission is being set </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$module</em>&nbsp;</td><td>Name of the module for which the action is defined </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$permission</em>&nbsp;</td><td>Boolean indicating whether the permission is to be given, or taken away </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$permtype</em>&nbsp;</td><td>String indicating whether $usergroupid represents a user or a group </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Boolean True indicating success, false indicating failure </dd></dl>

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00752">752</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
<a class="anchor" id="a8002ed86c26089c9a8f328694d3c07ac"></a><!-- doxytag: member="permission.lib.php::unsetPagePermission" ref="a8002ed86c26089c9a8f328694d3c07ac" args="($usergroupid, $pageid, $action, $module, $permtype= 'group')" -->
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsetPagePermission </td>
          <td>(</td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>usergroupid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>pageid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>action</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>module</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">$&nbsp;</td>
          <td class="paramname"> <em>permtype</em> = <code>'group'</code></td><td>&nbsp;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td><td></td>
        </tr>
      </table>
</div>
<div class="memdoc">
<p>Unsets permissions for a given user or group for a given page </p>
<dl><dt><b>Parameters:</b></dt><dd>
  <table border="0" cellspacing="2" cellpadding="0">
    <tr><td valign="top"></td><td valign="top"><em>$usergroupid</em>&nbsp;</td><td>Id of the user or group, whose permission is to be unset </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$pageid</em>&nbsp;</td><td>Page id of the current page </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$action</em>&nbsp;</td><td>Action for which the permission is to be unset </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$module</em>&nbsp;</td><td>Name of the module to which the action belongs </td></tr>
    <tr><td valign="top"></td><td valign="top"><em>$permtype</em>&nbsp;</td><td>A string indicating whether $usergroupid refers to a user or a group </td></tr>
  </table>
  </dd>
</dl>
<dl class="return"><dt><b>Returns:</b></dt><dd>Boolean, true indicating success, and false indicating failure </dd></dl>

<p>Definition at line <a class="el" href="permission_8lib_8php_source.html#l00718">718</a> of file <a class="el" href="permission_8lib_8php_source.html">permission.lib.php</a>.</p>

</div>
</div>
</div>
<hr class="footer"/><address class="footer"><small>Generated on Sun Jan 2 2011 04:55:32 for Pragyan CMS by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.7.1 </small></address>
</body>
</html>
